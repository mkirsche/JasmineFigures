counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$TYPE = "INS"
ggplot(df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL"), aes(x = LenCategory, fill = SVTYPE, y = 1)) +
geom_bar(position = "stack", stat = "identity")+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
ggplot(df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL"), aes(x = LenCategory, fill = SVTYPE, y = 1)) +
geom_bar(position = "stack", stat = "identity")+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
ggplot(df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")) +
geom_bar(position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
ggplot(df) +
geom_bar(df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
ggplot() +
geom_bar(df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$LenCategory = ifelse(df$SVLEN > 0 & df$SVLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < 0 & df$SVLEN >= -50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 50 & df$SVLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -50 & df$SVLEN >= -200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 200 & df$SVLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -200 & df$SVLEN >= -500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 500 & df$SVLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -500 & df$SVLEN >= -1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 1000 & df$SVLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -1000 & df$SVLEN >= -5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN > 5000, "5000+", df$LenCategory)
df$LenCategory = ifelse(df$SVLEN < -5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("5k+", "1k-5k", "500-1k", "200-500", "50-200", "1-50",
"1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 200, "50-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 1000, "500-1000", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 5000, "1000-5000", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000, "5000+", df$LenCategory)
df$LenCategory <- factor(df$LenCategory,levels = c("1-50", "50-200", "200-500", "500-1000", "1000-5000", "5000+"))
df %>% group_by(df$LenCategory) %>% tally()
labellist = c("1-50", "50-200", "200-500", "500-1k", "1k-5k", "5k+")
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 100, "50-100", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 100 & df$ABSLEN <= 200, "100-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 500, "200-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 1000, "500-1k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 5000, "1k-5k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000, "5k+", df$LenCategory)
labellist = c("1-50", "50-100", "100-200", "200-500", "500-1k", "1k-5k", "5k+")
df$LenCategory <- factor(df$LenCategory,levels = labellist)
df %>% group_by(df$LenCategory) %>% tally()
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 100, "50-100", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 100 & df$ABSLEN <= 200, "100-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 300, "200-300", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 300 & df$ABSLEN <= 400, "300-400", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 400 & df$ABSLEN <= 500, "400-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 750, "500-750", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 750 & df$ABSLEN <= 1000, "750-1k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 5000, "1k-5k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000, "5k+", df$LenCategory)
labellist = c("1-50", "50-100", "100-200", "200-300", "300-400", "400-500", "500-750", "750-1k", "1k-5k", "5k+")
df$LenCategory <- factor(df$LenCategory,levels = labellist)
df %>% group_by(df$LenCategory) %>% tally()
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "0"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 100, "50-100", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 100 & df$ABSLEN <= 200, "100-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 300, "200-300", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 300 & df$ABSLEN <= 400, "300-400", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 400 & df$ABSLEN <= 500, "400-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 750, "500-750", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 750 & df$ABSLEN <= 1000, "750-1k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 2000, "1k-2k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 2000 & df$ABSLEN <= 5000, "2k-5k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000 & df$ABSLEN <= 10000, "5k-10k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 10000, "10k+", df$LenCategory)
labellist = c("1-50", "50-100", "100-200", "200-300", "300-400", "400-500", "500-750", "750-1k", "1k-2k", "2k-5k", "5k-10k", "10k+")
df$LenCategory <- factor(df$LenCategory,levels = labellist)
df %>% group_by(df$LenCategory) %>% tally()
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
tech_specific_length <- function(df, caller, outfile, filter)
{
df$LenCategory = "TRA"
df$ABSLEN = abs(df$SVLEN)
df$LenCategory = ifelse(df$ABSLEN > 0 & df$ABSLEN <= 50, "1-50", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 50 & df$ABSLEN <= 100, "50-100", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 100 & df$ABSLEN <= 200, "100-200", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 200 & df$ABSLEN <= 300, "200-300", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 300 & df$ABSLEN <= 400, "300-400", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 400 & df$ABSLEN <= 500, "400-500", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 500 & df$ABSLEN <= 750, "500-750", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 750 & df$ABSLEN <= 1000, "750-1k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 1000 & df$ABSLEN <= 2000, "1k-2k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 2000 & df$ABSLEN <= 5000, "2k-5k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 5000 & df$ABSLEN <= 10000, "5k-10k", df$LenCategory)
df$LenCategory = ifelse(df$ABSLEN > 10000, "10k+", df$LenCategory)
labellist = c("TRA", "1-50", "50-100", "100-200", "200-300", "300-400", "400-500", "500-750", "750-1k", "1k-2k", "2k-5k", "5k-10k", "10k+")
df$LenCategory <- factor(df$LenCategory,levels = labellist)
df %>% group_by(df$LenCategory) %>% tally()
counts <- df %>% filter(df$SVTYPE == "INS" | df$SVTYPE == "DEL") %>% group_by(LenCategory) %>% count()
counts$SVTYPE = "INS"
#df %>% filter(SVTYPE == "INS" | SVTYPE == "DEL")
ggplot(df) +
geom_bar(data = df %>% filter(SVTYPE == "INS"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = 1))+
geom_bar(data = df %>% filter(SVTYPE == "DEL"), position = "stack", stat = "identity", aes(x = LenCategory, fill = SVTYPE, y = -1))+
scale_x_discrete(labels=labellist) +
xlab("Length") +
ylab("Count") +
labs(title = paste("Indels by Length (", caller, ")")) +
theme(plot.title = element_text(size = 18, hjust = 0.5),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 16),
axis.title.y = element_text(size = 16),
legend.text = element_text(size = 12),
legend.title = element_text(size = 16),
) +
scale_fill_discrete(name = "Type") +
geom_text(data = counts, aes(x = LenCategory, y=n, label=n), position=position_dodge(width=0.9), vjust=-0.75)
ggsave(outfile, width= 12, height = 8)
}
outfile <- '/home/mkirsche/jasmine_data/figures/figure3/hg002_crosstech_hifi_indels.png'
tech_specific_length(df %>% filter(SUPP_VEC == 100), "Hifi-Only", outfile, T)
source('~/jasmine_data/figures/jasmine_plot/crosstech.R', echo=TRUE)
